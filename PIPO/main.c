#include "PIPO.h"
#include "type.h"
#include "PIPO_SBOX.h"

int main(void) {

	byte Plain[8] = { 0x09,0x85,0x52,0xF6,0x1E,0x27,0x00,0x26 };
	//byte Plain[8] = { 0xBE ,0x25 ,0xAA ,0xF8 ,0xF2 ,0x0E ,0xC6 ,0x89 };
	byte Cipher[8] = { 0, };
	byte MasterKey[16] = { 0x6D,0xC4,0x16,0xDD,0x77,0x94,0x28,0xD2,0x7E,0x1D,0x20,0xAD,0x2E,0x15,0x22,0x97 };
	//byte MasterKey[16] = { 0x2B ,0x7E ,0x15 ,0x16 ,0x28 ,0xAE ,0xD2 ,0xA6 ,0xAB ,0xF7 ,0x15 ,0x88 ,0x09 ,0xCF ,0x4F ,0x3C };

	printf("Ciphertext=====");
	Encryption(Plain, Cipher,MasterKey);
	for (int i = 0; i < 8; i++)
		printf("%02x ", Cipher[i]);
	printf("\n");
	printf("Plaintext======");
	Decryption(Cipher, Plain, MasterKey);
	
	for (int i = 0; i < 8; i++)
		printf("%02x ", Plain[i]);
	return 0;
}
